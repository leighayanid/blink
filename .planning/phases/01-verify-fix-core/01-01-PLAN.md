---
phase: 01-verify-fix-core
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: []
autonomous: false
---

<objective>
Verify end-to-end file transfer works reliably across browser tabs/devices.

Purpose: Confirm core functionality before UI polish work begins (CORE-01). Identify and document any bugs for fixing (CORE-02).
Output: Verified working file transfer OR documented bugs to fix.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/codebase/ARCHITECTURE.md
@.planning/codebase/CONCERNS.md

@app/composables/useDeviceDiscovery.ts
@app/composables/useWebRTC.ts
@app/composables/useFileTransfer.ts
@app/pages/index.vue
@server/routes/ws.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Start dev server and verify app builds</name>
  <files>package.json</files>
  <action>
    1. Run `npm install` to ensure dependencies are installed
    2. Run `npm run dev` to start the development server
    3. Verify server starts without errors
    4. Note the local URL (typically http://localhost:3000)
  </action>
  <verify>
    - Dev server starts without build errors
    - Console shows Nuxt ready message
    - No TypeScript errors during startup
  </verify>
  <done>Dev server running, ready for manual testing</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Hatid file sharing app running on dev server</what-built>
  <how-to-verify>
    **Test file transfer between two browser tabs:**

    1. Open http://localhost:3000 in Tab A (Chrome)
    2. Open http://localhost:3000 in Tab B (Chrome incognito OR different browser)
    3. Wait 2-3 seconds for device discovery

    **Verify discovery:**
    4. Tab A should show Tab B's device in the list
    5. Tab B should show Tab A's device in the list
    6. If no devices appear after 10s, check browser console for WebSocket errors

    **Test file transfer:**
    7. In Tab A, click on Tab B's device to select it
    8. Drag a small file (< 1MB) to the upload area OR click to select file
    9. Verify transfer progress shows in both tabs
    10. In Tab B, verify file downloads automatically when complete
    11. Open the downloaded file - verify it matches the original

    **Test larger file (optional but recommended):**
    12. Repeat steps 7-11 with a larger file (5-10MB)
    13. Note transfer speed and any issues

    **Check for errors:**
    14. Open browser DevTools Console in both tabs
    15. Look for any red errors during the transfer process
    16. Note any warnings that might indicate problems
  </how-to-verify>
  <resume-signal>
    Report your findings:
    - "works" - File transfer completed successfully, no issues
    - "works with issues: [describe]" - Transfer works but has problems
    - "broken: [describe]" - Transfer fails, describe what happened
  </resume-signal>
</task>

<task type="auto">
  <name>Task 3: Document findings and address critical bugs</name>
  <files>.planning/phases/01-verify-fix-core/01-01-SUMMARY.md</files>
  <action>
    Based on checkpoint findings:

    **If "works":**
    - Document successful verification in SUMMARY.md
    - Note any minor observations for future improvement
    - Phase 1 complete

    **If "works with issues":**
    - Document the issues found
    - Assess severity: critical (blocks usage) vs minor (annoying but usable)
    - For critical issues: attempt fix and re-verify
    - For minor issues: document for Phase 2 or future work

    **If "broken":**
    - Analyze browser console errors
    - Check server logs for WebSocket issues
    - Identify root cause using codebase knowledge
    - Implement fix targeting the specific failure
    - Re-test to verify fix works

    Common issues from CONCERNS.md to check:
    - WebSocket reconnection infinite loop
    - File transfer setTimeout ordering issues
    - WebRTC connection state not tracked properly
    - PeerJS connection failures
  </action>
  <verify>
    - SUMMARY.md created with findings
    - If bugs fixed: re-test confirms fix works
  </verify>
  <done>Findings documented, critical bugs (if any) fixed</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Dev server runs without errors
- [ ] File transfer tested manually
- [ ] Findings documented
- [ ] Critical bugs (if found) fixed and re-verified
</verification>

<success_criteria>
- File transfer verified working end-to-end OR
- Bugs identified, documented, and critical ones fixed
- SUMMARY.md documents the verification results
</success_criteria>

<output>
After completion, create `.planning/phases/01-verify-fix-core/01-01-SUMMARY.md`
</output>
